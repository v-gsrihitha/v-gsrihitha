id: fb5aaeb6-14fa-45e8-bb4a-6d4c642a710e
Function:
  Title: Parser for SlackAudit
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: SlackAudit
FunctionAlias: SlackAudit
FunctionQuery: |
  let SlackAudit_view = view () {
    SlackAudit_CL
      | extend 
        DetailsMobileOnly=column_ifexists('details_mobile_only_b', ''),
    		DetailsWebOnly=column_ifexists('details_web_only_b', ''),
    		DetailsKickerId=column_ifexists('details_kicker_id_s', ''),
    		DetailsKickerName=column_ifexists('details_kicker_name_s', ''),
    		DetailsKickerEmail=column_ifexists('details_kicker_email_s', ''),
    		DetailsKickerTeam=column_ifexists('details_kicker_team_s', ''),
    		DetailsAppOwnerId=column_ifexists('details_app_owner_id_s', ''),
    		DetailsGranularBotToken=column_ifexists('details_granular_bot_token_b', ''),
    		DetailsNewScopes=column_ifexists('details_new_scopes_s', ''),
    		DetailsPreviousScopes=column_ifexists('details_previous_scopes_s', ''),
    		EntityUsergroupId=column_ifexists('entity_usergroup_id_s', ''),
    		EntityUsergroupName=column_ifexists('entity_usergroup_name_s', ''),
    		DetailsKickerType=column_ifexists('details_kicker_type_s', ''),
    		DetailsKickerUserId=column_ifexists('details_kicker_user_id_s', ''),
    		DetailsKickerUserName=column_ifexists('details_kicker_user_name_s', ''),
    		DetailsKickerUserEmail=column_ifexists('details_kicker_user_email_s', ''),
    		DetailsKickerUserTeam=column_ifexists('details_kicker_user_team_s', ''),
    		DetailsInviterId=column_ifexists('details_inviter_id_s', ''),
    		DetailsInviterName=column_ifexists('details_inviter_name_s', ''),
    		DetailsInviterEmail=column_ifexists('details_inviter_email_s', ''),
    		DetailsInviterTeam=column_ifexists('details_inviter_team_s', ''),
    		DetailsInviterType=column_ifexists('details_inviter_type_s', ''),
    		DetailsInviterUserId=column_ifexists('details_inviter_user_id_s', ''),
    		DetailsInviterUserName=column_ifexists('details_inviter_user_name_s', ''),
    		DetailsInviterUserEmail=column_ifexists('details_inviter_user_email_s', ''),
    		DetailsInviterUserTeam=column_ifexists('details_inviter_user_team_s', ''),
    		DetailsIsWorkflow=column_ifexists('details_is_workflow_b', ''),
    		EntityAppId=column_ifexists('entity_app_id_s', ''),
    		EntityAppName=column_ifexists('entity_app_name_s', ''),
    		EntityAppIsDistributed=column_ifexists('entity_app_is_distributed_b', ''),
    		EntityAppIsDirectoryApproved=column_ifexists('entity_app_is_directory_approved_b', ''),
    		EntityAppIsWorkflowApp=column_ifexists('entity_app_is_workflow_app_b', ''),
    		EntityAppScopes=column_ifexists('entity_app_scopes_s', ''),
    		DetailsIsInternalIntegration=column_ifexists('details_is_internal_integration_b', ''),
    		DetailsBotScopes=column_ifexists('details_bot_scopes_s', ''),
    		EntityChannelId=column_ifexists('entity_channel_id_s', ''),
    		EntityChannelPrivacy=column_ifexists('entity_channel_privacy_s', ''),
    		EntityChannelName=column_ifexists('entity_channel_name_s', ''),
    		EntityChannelIsShared=column_ifexists('entity_channel_is_shared_b', ''),
    		EntityChannelIsOrgShared=column_ifexists('entity_channel_is_org_shared_b', ''),
    		DetailsType=column_ifexists('details_type_s', ''),
    		EntityUserId=column_ifexists('entity_user_id_s', ''),
    		EntityUserName=column_ifexists('entity_user_name_s', ''),
    		EntityUserEmail=column_ifexists('entity_user_email_s', ''),
    		EntityUserTeam=column_ifexists('entity_user_team_s', ''),
    		Id=column_ifexists('id_g', ''),
    		DateCreate=column_ifexists('date_create_d', ''),
    		Action=column_ifexists('action_s', ''),
    		ActorType=column_ifexists('actor_type_s', ''),
    		ActorUserId=column_ifexists('actor_user_id_s', ''),
    		ActorUserName=column_ifexists('actor_user_name_s', ''),
    		ActorUserEmail=column_ifexists('actor_user_email_s', ''),
    		ActorUserTeam=column_ifexists('actor_user_team_s', ''),
    		EntityType=column_ifexists('entity_type_s', ''),
    		EntityFileId=column_ifexists('entity_file_id_s', ''),
    		EntityFileName=column_ifexists('entity_file_name_s', ''),
    		EntityFileFiletype=column_ifexists('entity_file_filetype_s', ''),
    		EntityFileTitle=column_ifexists('entity_file_title_s', ''),
    		ContextLocationType=column_ifexists('context_location_type_s', ''),
    		ContextLocationId=column_ifexists('context_location_id_s', ''),
    		ContextLocationName=column_ifexists('context_location_name_s', ''),
    		ContextLocationDomain=column_ifexists('context_location_domain_s', ''),
    		ContextUA=column_ifexists('context_ua_s', ''),
    		ContextIpAddress=column_ifexists('context_ip_address_s', ''),
    		ContextSessionId=column_ifexists('context_session_id_d', ''),
    		ActionDescription=column_ifexists('action_description_s', '')
  	};
  let SlackAuditV1_view = view () {
		SlackAuditNativePoller_CL
      | extend
           DetailsMobileOnly=column_ifexists('details_mobile_only_b', ''), 
    		   DetailsWebOnly=column_ifexists('details_web_only_b', ''),
    		   DetailsKickerId=column_ifexists('details_kicker_id_s', ''),
    		   DetailsKickerName=column_ifexists('details_kicker_name_s', ''),
    		   DetailsKickerEmail=column_ifexists('details_kicker_email_s', ''),
    		   DetailsKickerTeam=column_ifexists('details_kicker_team_s', ''),
    		   DetailsAppOwnerId=column_ifexists('details_app_owner_id_s', ''),
    		   DetailsGranularBotToken=column_ifexists('details_granular_bot_token_b', ''),
    		   DetailsNewScopes=column_ifexists('details_new_scopes_s', ''),
    		   DetailsPreviousScopes=column_ifexists('details_previous_scopes_s', ''),
    		   EntityUsergroupId=column_ifexists('entity_usergroup_id_s', ''),
    		   EntityUsergroupName=column_ifexists('entity_usergroup_name_s', ''),
    		   DetailsKickerType=column_ifexists('details_kicker_type_s', ''),
    		   DetailsKickerUserId=column_ifexists('details_kicker_user_id_s', ''),
    		   DetailsKickerUserName=column_ifexists('details_kicker_user_name_s', ''),
    		   DetailsKickerUserEmail=column_ifexists('details_kicker_user_email_s', ''),
    		   DetailsKickerUserTeam=column_ifexists('details_kicker_user_team_s', ''),
    		   DetailsInviterId=column_ifexists('details_inviter_id_s', ''),
    		   DetailsInviterName=column_ifexists('details_inviter_name_s', ''),
    		   DetailsInviterEmail=column_ifexists('details_inviter_email_s', ''),
    		   DetailsInviterTeam=column_ifexists('details_inviter_team_s', ''),
    		   DetailsInviterType=column_ifexists('details_inviter_type_s', ''),
    		   DetailsInviterUserId=column_ifexists('details_inviter_user_id_s', ''),
    		   DetailsInviterUserName=column_ifexists('details_inviter_user_name_s', ''),
    		   DetailsInviterUserEmail=column_ifexists('details_inviter_user_email_s', ''),
    		   DetailsInviterUserTeam=column_ifexists('details_inviter_user_team_s', ''),
    		   DetailsIsWorkflow=column_ifexists('details_is_workflow_b', ''),
    		   EntityAppId=column_ifexists('entity_app_id_s', ''),
    		   EntityAppName=column_ifexists('entity_app_name_s', ''),
    		   EntityAppIsDistributed=column_ifexists('entity_app_is_distributed_b', ''),
    		   EntityAppIsDirectoryApproved=column_ifexists('entity_app_is_directory_approved_b', ''),
    		   EntityAppIsWorkflowApp=column_ifexists('entity_app_is_workflow_app_b', ''),
    		   EntityAppScopes=column_ifexists('entity_app_scopes_s', ''),
    		   DetailsIsInternalIntegration=column_ifexists('details_is_internal_integration_b', ''),
    		   DetailsBotScopes=column_ifexists('details_bot_scopes_s', ''),
    		   EntityChannelId=column_ifexists('entity_channel_id_s', ''),
    		   EntityChannelPrivacy=column_ifexists('entity_channel_privacy_s', ''),
    		   EntityChannelName=column_ifexists('entity_channel_name_s', ''),
    		   EntityChannelIsShared=column_ifexists('entity_channel_is_shared_b', ''),
    		   EntityChannelIsOrgShared=column_ifexists('entity_channel_is_org_shared_b', ''),
    		   DetailsType=column_ifexists('details_type_s', ''),
    		   EntityUserId=column_ifexists('entity_user_id_s', ''),
    		   EntityUserName=column_ifexists('entity_user_name_s', ''),
    		   EntityUserEmail=column_ifexists('entity_user_email_s', ''),
    		   EntityUserTeam=column_ifexists('entity_user_team_s', ''),
    		   Id=column_ifexists('id_g', ''),
    		   DateCreate=column_ifexists('date_create_d', ''),
    		   Action=column_ifexists('action_s', ''),
    		   ActorType=column_ifexists('actor_type_s', ''),
    		   ActorUserId=column_ifexists('actor_user_id_s', ''),
    		   ActorUserName=column_ifexists('actor_user_name_s', ''),
    		   ActorUserEmail=column_ifexists('actor_user_email_s', ''),
    		   ActorUserTeam=column_ifexists('actor_user_team_s', ''),
    		   EntityType=column_ifexists('entity_type_s', ''),
    		   EntityFileId=column_ifexists('entity_file_id_s', ''),
    		   EntityFileName=column_ifexists('entity_file_name_s', ''),
    		   EntityFileFiletype=column_ifexists('entity_file_filetype_s', ''),
    		   EntityFileTitle=column_ifexists('entity_file_title_s', ''),
    		   ContextLocationType=column_ifexists('context_location_type_s', ''),
    		   ContextLocationId=column_ifexists('context_location_id_s', ''),
    		   ContextLocationName=column_ifexists('context_location_name_s', ''),
    		   ContextLocationDomain=column_ifexists('context_location_domain_s', ''),
    		   ContextUA=column_ifexists('context_ua_s', ''),
    		   ContextIpAddress=column_ifexists('context_ip_address_s', ''),
    		   ContextSessionId=column_ifexists('context_session_id_d', ''),
    		   ActionDescription=column_ifexists('action_description_s', ''),
           EventId=column_ifexists('id_g', ''),
           EventEndTime=column_ifexists('date_create_d', ''),
           DvcAction=column_ifexists('action_s', ''),
           SrcUserIdentity=column_ifexists('actor_user_id_s', ''),
           SrcUserName=column_ifexists('actor_user_name_s', ''),
           SrcUserEmail=column_ifexists('actor_user_email_s', ''),
           UserAgentOriginal=column_ifexists('context_ua_s', ''),
           SrcIpAddr=column_ifexists('context_ip_address_s', ''),
           DvcActionDesc=column_ifexists('action_description_s', '')
        };
    let SlackAuditV2_view = view () {
		 SlackAuditV2_CL
      | extend
          DetailsMobileOnly=column_ifexists('DetailsMobileOnly', ''), 
          DetailsWebOnly=column_ifexists('DetailsWebOnly', ''),
          DetailsKickerId=column_ifexists('DetailsKickerId', ''),
          DetailsKickerName=column_ifexists('DetailsKickerName', ''),
          DetailsKickerEmail=column_ifexists('DetailsKickerEmail', ''),
          DetailsKickerTeam=column_ifexists('DetailsKickerTeam', ''),
          DetailsAppOwnerId=column_ifexists('DetailsAppOwnerId', ''),
          DetailsGranularBotToken=column_ifexists('DetailsGranularBotToken', ''),
          DetailsNewScopes=column_ifexists('DetailsNewScopes', ''),
          DetailsPreviousScopes=column_ifexists('DetailsPreviousScopes', ''),
          EntityUsergroupId=column_ifexists('EntityUsergroupId', ''),
          EntityUsergroupName=column_ifexists('EntityUsergroupName', ''),
          DetailsKickerType=column_ifexists('DetailsKickerType', ''),
          DetailsKickerUserId=column_ifexists('DetailsKickerUserId', ''),
          DetailsKickerUserName=column_ifexists('DetailsKickerUserName', ''),
          DetailsKickerUserEmail=column_ifexists('DetailsKickerUserEmail', ''),
          DetailsKickerUserTeam=column_ifexists('DetailsKickerUserTeam', ''),
          DetailsInviterId=column_ifexists('DetailsInviterId', ''),
          DetailsInviterName=column_ifexists('DetailsInviterName', ''),
          DetailsInviterEmail=column_ifexists('DetailsInviterEmail', ''),
          DetailsInviterTeam=column_ifexists('DetailsInviterTeam', ''),
          DetailsInviterType=column_ifexists('DetailsInviterType', ''),
          DetailsInviterUserId=column_ifexists('DetailsInviterUserId', ''),
          DetailsInviterUserName=column_ifexists('DetailsInviterUserName', ''),
          DetailsInviterUserEmail=column_ifexists('DetailsInviterUserEmail', ''),
          DetailsInviterUserTeam=column_ifexists('DetailsInviterUserTeam', ''),
          DetailsIsWorkflow=column_ifexists('DetailsIsWorkflow', ''),
          EntityAppId=column_ifexists('EntityAppId', ''),
          EntityAppName=column_ifexists('EntityAppName', ''),
          EntityAppIsDistributed=column_ifexists('EntityAppIsDistributed', ''),
          EntityAppIsDirectoryApproved=column_ifexists('EntityAppIsDirectoryApproved', ''),
          EntityAppIsWorkflowApp=column_ifexists('EntityAppIsWorkflowApp', ''),
          EntityAppScopes=column_ifexists('EntityAppScopes', ''),
          DetailsIsInternalIntegration=column_ifexists('DetailsIsInternalIntegration', ''),
          DetailsBotScopes=column_ifexists('DetailsBotScopes', ''),
          EntityChannelId=column_ifexists('EntityChannelId', ''),
          EntityChannelPrivacy=column_ifexists('EntityChannelPrivacy', ''),
          EntityChannelName=column_ifexists('EntityChannelName', ''),
          EntityChannelIsShared=column_ifexists('EntityChannelIsShared', ''),
          EntityChannelIsOrgShared=column_ifexists('EntityChannelIsOrgShared', ''),
          DetailsType=column_ifexists('DetailsType', ''),
          EntityUserId=column_ifexists('EntityUserId', ''),
          EntityUserName=column_ifexists('EntityUserName', ''),
          EntityUserEmail=column_ifexists('EntityUserEmail', ''),
          EntityUserTeam=column_ifexists('EntityUserTeam', ''),
          Id=column_ifexists('Id', ''),
          DateCreate=column_ifexists('DateCreate', ''),
          Action=column_ifexists('Action', ''),
          ActorType=column_ifexists('ActorType', ''),
          ActorUserId=column_ifexists('ActorUserId', ''),
          ActorUserName=column_ifexists('ActorUserName', ''),
          ActorUserEmail=column_ifexists('ActorUserEmail', ''),
          ActorUserTeam=column_ifexists('ActorUserTeam', ''),
          EntityType=column_ifexists('EntityType', ''),
          EntityFileId=column_ifexists('EntityFileId', ''),
          EntityFileName=column_ifexists('EntityFileName', ''),
          EntityFileFiletype=column_ifexists('EntityFileFiletype', ''),
          EntityFileTitle=column_ifexists('EntityFileTitle', ''),
          ContextLocationType=column_ifexists('ContextLocationType', ''),
          ContextLocationId=column_ifexists('ContextLocationId', ''),
          ContextLocationName=column_ifexists('ContextLocationName', ''),
          ContextLocationDomain=column_ifexists('ContextLocationDomain', ''),
          ContextUA=column_ifexists('ContextUa', ''),
          ContextIpAddress=column_ifexists('ContextIpAddress', ''),
          ContextSessionId=column_ifexists('ContextSessionId', ''),
          ActionDescription=column_ifexists('ActionDescription', ''),           
          EventId=column_ifexists('Id', ''),
          EventEndTime=column_ifexists('DateCreate', ''),
          DvcAction=column_ifexists('Action', ''),
          SrcUserIdentity=column_ifexists('ActorUserId', ''),
          SrcUserName=column_ifexists('ActorUserName', ''),
          SrcUserEmail=column_ifexists('ActorUserEmail', ''),
          UserAgentOriginal=column_ifexists('ContextUa', ''),
          SrcIpAddr=column_ifexists('ContextIpAddress', ''),
          DvcActionDesc=column_ifexists('ActionDescription', '')  
     };
    union isfuzzy=true
    (SlackAudit_view),
    (SlackAuditV1_view),
    (SlackAuditV2_view)
	  | project TimeGenerated, DetailsMobileOnly,DetailsWebOnly, DetailsKickerId, DetailsKickerName, DetailsKickerEmail, DetailsKickerTeam,DetailsAppOwnerId, DetailsGranularBotToken, DetailsNewScopes, DetailsPreviousScopes, EntityUsergroupId, EntityUsergroupName, DetailsKickerType, DetailsKickerUserId, DetailsKickerUserName, DetailsKickerUserEmail, DetailsKickerUserTeam, DetailsInviterId, DetailsInviterName, DetailsInviterEmail, DetailsInviterTeam, DetailsInviterType, DetailsInviterUserId, DetailsInviterUserName, DetailsInviterUserEmail, DetailsInviterUserTeam, DetailsIsWorkflow, EntityAppId, EntityAppName, EntityAppIsDistributed, EntityAppIsDirectoryApproved, EntityAppIsWorkflowApp, EntityAppScopes, DetailsIsInternalIntegration, DetailsBotScopes, EntityChannelId, EntityChannelPrivacy, EntityChannelName, EntityChannelIsShared, EntityChannelIsOrgShared, DetailsType, EntityUserId, EntityUserName, EntityUserEmail, EntityUserTeam, Id, DateCreate, Action, ActorType, ActorUserId, ActorUserName, ActorUserEmail, ActorUserTeam, EntityType, EntityFileId, EntityFileName, EntityFileFiletype, EntityFileTitle, ContextLocationType, ContextLocationId, ContextLocationName, ContextLocationDomain, ContextUA, ContextIpAddress, ContextSessionId, ActionDescription, EventId, EventEndTime, DvcAction, SrcUserIdentity, SrcUserName, SrcUserEmail, UserAgentOriginal, SrcIpAddr, DvcActionDesc
